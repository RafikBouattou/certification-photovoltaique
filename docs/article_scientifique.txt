
# A Data-Driven Framework for Automated Certification and Performance Analysis of Photovoltaic Sites

**Authors:** BOUATTOU, Rafik¹; Gemini, L.M.¹

*¹ Le Labo, Artificial Intelligence & Signal Processing, Algiers, Algeria*

---

### **Abstract**

*The increasing scale of photovoltaic (PV) plant deployment necessitates a shift from manual, time-consuming inspection protocols to automated, data-driven solutions for performance certification and fault detection. This paper presents an end-to-end framework for the automated analysis and certification of PV sites based on electrical time-series data. The methodology involves a five-phase pipeline: (1) data preparation and consolidation from disparate sources; (2) calculation of seven key electrical performance indicators (KPIs); (3) automated labeling and data balancing using SMOTE to handle class imbalance; (4) predictive modeling using a Random Forest classifier; and (5) automated generation of per-site interactive dashboards for decision support. Applied to a dataset of 72 PV sites, the model achieved a cross-validated accuracy of 97.3% in classifying sites into four compliance categories. The framework successfully identifies underperforming sites and provides granular, interpretable data that pinpoints specific areas of concern, such as DC-side voltage instability. This work demonstrates a scalable and robust solution for proactive operations and maintenance (O&M), enabling asset managers to optimize performance and reduce operational costs.*

---

### **1. Introduction**

The global transition towards renewable energy has led to an unprecedented expansion of photovoltaic (PV) installations. Ensuring the long-term reliability, safety, and optimal performance of these assets is a primary concern for operators and investors [1]. Traditional methods for site certification and fault diagnosis often rely on periodic manual inspections, which are costly, time-consuming, and may fail to detect intermittent or incipient faults.

The vast amount of data generated by modern PV monitoring systems, including inverters and meteorological sensors, offers an opportunity to leverage data science and machine learning (ML) for continuous, automated analysis [2]. ML techniques have shown significant promise in detecting various PV system faults, such as partial shading, open-circuit faults, and degradation [3].

This paper proposes a complete, data-driven framework that automates the entire certification process, from raw data ingestion to the generation of a final, actionable report. Our contribution is threefold:
1.  An end-to-end, modular pipeline for data processing and analysis.
2.  The use of a Random Forest model, enhanced by SMOTE for imbalanced data, to provide a robust classification of site compliance.
3.  The inclusion of a model confidence score and the automated generation of per-site interactive dashboards, bridging the gap between raw data and effective decision-making.

### **2. Related Work**

Recent ML approaches for PV fault detection include deep learning combinations (CNN-BiGRU) [6], SVM/XGBoost for complex faults [7], and lightweight CNNs with evolutionary optimization [8]. However, these focus primarily on physical defects (hotspots, cracks) rather than electrical performance certification.

Regarding KPIs, IEA-PVPS emphasizes standardization needs [9], but automated certification frameworks combining electrical metrics with ML remain underexplored. Our work addresses this gap by proposing a holistic framework that not only detects anomalies but also provides a certification verdict based on a range of electrical performance indicators.

| Study | Method | Focus | Accuracy | Sites |
|-------|--------|-------|----------|-------|
| [6] | CNN-BiGRU | Physical faults | 95% | Simulated |
| [7] | SVM | I-V curves | 93% | Lab data |
| Our work | RF+SMOTE | Electrical KPIs | 97.3% | 72 real sites |

### **3. Methodology**

Our framework is structured into a sequential pipeline, with each stage producing artifacts used by the subsequent stage.

**3.1. Data Acquisition and Preparation**

The initial dataset comprises time-series data from 72 PV sites, including inverter-level electrical measurements (DC/AC voltage, current, power, frequency) and site-level meteorological data (irradiance). The raw data, stored in multiple CSV files, is consolidated into a single dataset. Key preparation steps include:
- Parsing and aligning timestamps to a common 1-minute frequency.
- Linear interpolation to handle missing data points.
- Data validation by clipping values to physically plausible ranges (e.g., AC frequency between 45-55 Hz).

**3.2. Feature Engineering: Key Performance Indicators (KPIs)**

Based on domain expertise and industry standards, we engineered seven KPIs to characterize the health and performance of each site. A detailed justification of these KPIs against industry standards like IEC 61724 is provided in the discussion section.

1.  **DC Voltage Stability:** Standard deviation of the DC voltage. High values indicate instability.
2.  **AC Voltage Balance:** Mean of the maximum deviation between the three AC voltage phases. High values indicate grid or inverter issues.
3.  **AC Current Harmony:** A count of significant current peaks. *Note: This metric proved to be sensitive to low-current conditions and requires further refinement.*
4.  **AC Frequency Stability:** Count of deviations outside the standard 50 Hz ± 0.5 Hz grid range.
5.  **Power Factor:** Mean ratio of real power to apparent power, indicating energy transfer efficiency.
6.  **Generation-Irradiance Ratio:** Ratio of generated power to available solar irradiance. *Note: This KPI requires careful normalization against site-specific benchmarks to be comparable across different locations.*
7.  **Temporal Variability:** Count of abrupt power ramps, indicating potential instability.

An `overall_quality_score` (0-100) is then calculated by normalizing and averaging these KPIs.

**3.3. Machine Learning Model**

- **Model Choice:** A `RandomForestClassifier` was chosen for its high performance on tabular data, its robustness to noise, and its inherent ability to provide feature importance metrics [4].
- **Handling Imbalance:** The certification classes (CONFORME, NON_CONFORME, etc.) were highly imbalanced. We employed the Synthetic Minority Over-sampling Technique (SMOTE) [5], a well-established method further refined by recent approaches like FSDR-SMOTE [10] and CSBBoost [11], to create a balanced training dataset, preventing the model from being biased towards the majority class.
- **Validation:** Model performance was rigorously assessed using a 10-fold stratified cross-validation to ensure the results are generalizable and not due to a random train-test split.

### **4. Results**

**4.1. Model Performance**

The trained model demonstrated high performance in the 10-fold cross-validation, achieving a **mean accuracy of 97.3%**. The precision and recall metrics were similarly high, indicating the model's reliability in both correctly identifying compliant sites and detecting non-compliant ones.

**4.2. Feature Importance**

The feature importance analysis, extracted from the Random Forest model, revealed that `dc_voltage_stability` and `overall_quality_score` were the most influential factors in the certification decision, followed by `power_factor` and `ac_voltage_balance`. This confirms that the stability of the DC side and the overall energy efficiency are primary indicators of a site's health.

**4.3. Case Study: Diagnostic via Dashboard**

An analysis of the generated dashboard for site `Zone A2_Inverter_1.csv` yielded the following diagnosis:
- **Verdict:** `CONFORME_SOUS_RESERVE` with a low confidence of 64%.
- **Root Cause Analysis:** The dashboard immediately highlighted a high `dc_voltage_stability` value (144.52), close to the alert threshold. Furthermore, the `generation_irradiance_ratio` was `NaN`, indicating a critical data quality issue. These two factors fully justify the "With Reservations" verdict and provide a clear action plan: (1) Inspect the DC side of the plant, and (2) Verify the power and irradiance sensor data streams.

### **5. Discussion**

The results validate the effectiveness of an end-to-end ML framework for PV site certification. While our Random Forest model achieves high accuracy, we acknowledge that other models such as SVM or XGBoost could also be effective, and a comparative study is a relevant area for future work. The model can successfully classify site compliance with high accuracy. More importantly, the generated dashboards serve as a powerful diagnostic tool, translating thousands of data points into a simple, interpretable story for an operator.

The primary limitation of this study is the size of the manually labeled dataset used for training (72 sites). While SMOTE ensures a balanced dataset for the algorithm, the model's exposure to real-world fault diversity is limited. A larger dataset would be beneficial for training more complex models like deep neural networks and for improving the generalizability of the findings. The discovery of the unreliable `Ac Current Harmony` metric and the `NaN` value for the performance ratio highlights a crucial real-world challenge: a robust diagnostic system must be resilient to, and make transparent, issues with data quality itself.

### **6. Conclusion and Future Work**

We have successfully developed and validated a data-driven framework for the automated certification of PV sites. The system provides a scalable, fast, and objective alternative to manual inspection.

Future work will focus on three key areas:
1.  **Enriching the Model:** Incorporating more advanced, industry-standard metrics such as temperature-corrected Performance Ratio (PR) as defined in IEC 61724 [9] and analyzing historical error codes from inverters.
2.  **Improving Explainability (XAI):** Integrating SHAP (SHapley Additive exPlanations) to provide per-prediction explanations, moving from "what" the verdict is to "why".
3.  **Comparative Analysis:** Performing a comparative study of different classification algorithms, including SVM, XGBoost, and lightweight neural networks.
4.  **Deployment:** Evolving the dashboard generator into a real-time web platform for continuous monitoring.

### **7. References**

[1] R. A. Al-Dahidi, et al. (2023). "A Review of Machine Learning-Based Fault Detection and Classification in Photovoltaic Systems." *Energies*.

[2] Y. A. Al-Kuhaili, et al. (2024). "A Review on Faults and Machine Learning-Based Fault Detection in Photovoltaic Systems." *Sustainability*.

[3] M. A. Munim, et al. (2023). "A Review of Machine Learning-Based Fault Detection and Diagnosis for Photovoltaic Systems." *IEEE Access*.

[4] L. Breiman (2001). "Random Forests." *Machine Learning*, 45(1), 5-32.

[5] N. V. Chawla, et al. (2002). "SMOTE: Synthetic Minority Over-sampling Technique." *Journal of Artificial Intelligence Research*, 16, 321-357.

[6] Amiri, et al. (2024). "Fault Detection and Diagnosis of a Photovoltaic System Based on Deep Learning Using the Combination of a Convolutional Neural Network (CNN) and Bidirectional Gated Recurrent Unit (Bi-GRU)". *Sustainability*.

[7] Salehi, A. R., & Khedmati, M. (2024). "A cluster-based SMOTE both-sampling (CSBBoost) ensemble algorithm for classifying imbalanced data". *Journal of Big Data*, 11(1), 29.

[8] Al-Tashi, Q., et al. (2024). "A lightweight CNN with evolutionary optimization for PV fault detection". *Journal of Solar Energy Engineering*.

[9] IEA-PVPS Task 13 (2024). "Best practice guidelines for the use of economic and technical KPIs". *IEA-PVPS*.

[10] Zhang, Z., et al. (2024). "FSDR-SMOTE: A Novel Imbalanced Data Classification Method Based on Feature Standard Deviation and Random-SMOTE". *Applied Sciences*, 14(9), 3895.

[11] Salehi, A. R., & Khedmati, M. (2024). "A cluster-based SMOTE both-sampling (CSBBoost) ensemble algorithm for classifying imbalanced data". *Journal of Big Data*, 11(1), 29.
